<ng-template #commentModal let-c="close" id='comment-modal'>

	<div class="modal-header">
		<h2 class="modal-title">Comments for {{key}}</h2>
		<button type="button" class="close" aria-label="Close" (click)="c()">
			<span aria-hidden="true">&times;</span>
		</button>
	</div>

	<ngb-accordion #acc="ngbAccordion" activeIds='{{openPanelIds}}' [type]='danger' [destroyOnHide]='false'>

		<ngb-panel *ngFor='let comment of comments; index as i' [id]="key+i">
			<!-- title -->
			<ng-template ngbPanelTitle>
				<div class='comment-header' data-id={{comment.id}}>
					<span>
						{{comment.display_name}}
						<img src="http://presence.q.att.com/presence/{{comment.username}}.gif">
					</span>
					<span class="float-right">
						{{comment.created | amDateFormat:'MM/D/YY h:mm A'}}
					</span>
					
				</div>
			</ng-template>
			
			<!-- body -->
			<ng-template ngbPanelContent>

				<!-- editing buttons -->
				<span class='edit-buttons'>
					<button 
						type="button" 
						class="btn btn-outline-info" 
						*ngIf='comment.username == user.username' 
						(click)="toggleEditing(comment)">
							{{comment.closeText}}
					</button>

					<button 
						[hidden]="!comment.isEditing" 
						type="button" 
						class="btn btn-outline-success"
						
						(click)="editComment(comment)">
							Save Edit
					</button>

					<button 
						type="button" 
						class="btn btn-outline-danger" 
						*ngIf='!comment.isEditing && comment.username == user.username' 
						(click)="deleteComment(comment.id)">
							Delete Comment
					</button>
				</span>
				
				<div [hidden]="comment.isEditing" [innerHTML]="comment.comment | commentFormat:attachments | safehtml"></div>
				<textarea
					[id]=comment.editId
					[hidden]="!comment.isEditing" 
					class='edit-area' 
					cols="100" rows=25 
					value={{comment.comment}}
					>
				</textarea>

			</ng-template>

		</ngb-panel>
	</ngb-accordion>
		
	<div class="modal-footer">
		<button type="button" class="btn btn-outline-success" (click)="c()">Close</button>
	</div>
</ng-template>




<ng-template #deleteModal let-c="close" let-d="dismiss">

	<div class="modal-header">
		<h4 class="modal-title">Delete {{comment_id}}</h4>

		<button type="button" class="close" aria-label="Close" (click)="d()">
			<span aria-hidden="true">&times;</span>
		</button>
	</div>

	<div class="modal-body">
		<p>Are you sure you want to delete comment {{comment_id}}?</p>
	</div>

	<div class="modal-footer">
		<button type="button" class="btn btn-outline-success" (click)="c()">
			Delete Comment
		</button>
		<button type="button" class="btn btn-outline-danger" (click)="d()">Cancel</button>
	</div>

</ng-template>

